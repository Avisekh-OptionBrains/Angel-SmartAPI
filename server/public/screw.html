<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Place Order Modal</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      /* Modal Styling */
      .modal-content {
        border-radius: 10px;
      }
      .btn-place-order {
        width: 100%;
        padding: 10px;
      }
      .form-control {
        margin-bottom: 10px;
      }
      .modal-header {
        background-color: #f8f9fa;
        border-bottom: 1px solid #ddd;
      }
      .modal-title {
        font-weight: bold;
      }
      .modal-content.buy {
        background-color: #d4edda; /* Green for Buy */
      }
      .modal-content.sell {
        background-color: #f8d7da; /* Red for Sell */
      }
    </style>
  </head>
  <body>
    <!-- Place Order Modal -->
    <div
      class="modal fade"
      id="placeOrderModal"
      tabindex="-1"
      aria-labelledby="placeOrderModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="placeOrderModalLabel">Place Order</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="placeOrderForm">
              <div class="mb-3">
                <label for="symbol" class="form-label">Trading Symbol</label>
                <input
                  type="text"
                  class="form-control"
                  id="symbol"
                  required
                  placeholder="Enter Symbol (e.g., INFY-EQ)"
                />
              </div>
              <div class="mb-3">
                <label for="quantity" class="form-label">Quantity</label>
                <input
                  type="number"
                  class="form-control"
                  id="quantity"
                  required
                  placeholder="Enter Quantity"
                />
              </div>
              <div class="mb-3">
                <label for="orderType" class="form-label">Order Type</label>
                <select class="form-control" id="orderType">
                  <option value="MARKET">Market Order</option>
                  <option value="LIMIT">Limit Order</option>
                  <option value="STOPLOSS_MARKET">
                    Stop Loss Market Order
                  </option>
                  <option value="STOPLOSS_LIMIT">Stop Loss Limit Order</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="productType" class="form-label">Product Type</label>
                <select class="form-control" id="productType">
                  <option value="INTRADAY">Intraday</option>
                  <option value="DELIVERY">Delivery</option>
                  <option value="CARRYFORWARD">Carryforward</option>
                </select>
              </div>
              <input type="hidden" id="symboltoken" value="3045" />
              <!-- Hidden Symbol Token -->
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-place-order"
              id="placeOrderButton"
            >
              Place Order
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS and Popper -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.min.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Initialize Bootstrap Modal
        const placeOrderModal = new bootstrap.Modal(
          document.getElementById("placeOrderModal")
        );

        // Open modal when needed (for testing, you can trigger manually)
        placeOrderModal.show();

        // Handle keyboard events for Buy (+) and Sell (-)
        document.addEventListener("keydown", function (event) {
          if (event.key === "+") {
            // Simulate Buy order
            setTransactionType("BUY");
          } else if (event.key === "-") {
            // Simulate Sell order
            setTransactionType("SELL");
          }
        });

        // Set transaction type and update modal background color
        function setTransactionType(transactionType) {
          const modalContent = document.querySelector(".modal-content");
          if (transactionType === "BUY") {
            modalContent.classList.add("buy");
            modalContent.classList.remove("sell");
          } else {
            modalContent.classList.add("sell");
            modalContent.classList.remove("buy");
          }
        }

        // Place Order Button click handler
        document
          .getElementById("placeOrderButton")
          .addEventListener("click", function () {
            const orderData = getOrderData();
            console.log(orderData); // You can replace this with your order API call
            placeOrderModal.hide();
          });

        // Function to get order data
        function getOrderData() {
          const symbol = document.getElementById("symbol").value;
          const quantity = document.getElementById("quantity").value;
          const orderType = document.getElementById("orderType").value;
          const productType = document.getElementById("productType").value;
          const symboltoken = document.getElementById("symboltoken").value;

          return {
            exchange: "NSE",
            tradingsymbol: symbol,
            quantity: quantity,
            disclosedquantity: quantity, // Default disclosed quantity is same as quantity
            transactiontype: document
              .querySelector(".modal-content")
              .classList.contains("buy")
              ? "BUY"
              : "SELL",
            ordertype: orderType,
            producttype: productType,
            variety: "NORMAL",
            symboltoken: symboltoken,
          };
        }
      });
    </script>
  </body>
</html>
